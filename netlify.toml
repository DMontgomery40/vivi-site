[build]
command = "corepack pnpm i && corepack pnpm build"
publish = "dist"

[context.production]
command = "corepack pnpm i && corepack pnpm build"

# Keep the Faxbot demo at /admin
[[redirects]]
from = "/admin"
to = "https://faxbot.net/admin-demo/"
status = 302
force = true

# Serve the AGRO GUI directly at /agro
[[redirects]]
from = "/agro"
to = "/agro/index.html"
status = 200
force = true

# SPA fallback (must be last)

[[redirects]]
from = "/agro-api/*"
to = "https://01589e7f-a5a7-4d85-a1c3-f764243a647a.cfargotunnel.com/api/:splat"
status = 200
force = true


[[redirects]]
from = "/agro/*"
to = "/agro/:splat"
status = 200
force = true

[[redirects]]
from = "/*"
to = "/index.html"
status = 200